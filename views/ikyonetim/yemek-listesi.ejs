<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="utf-8">
    <title>Kontrol Paneli</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta content="A fully featured admin theme which can be used to build CRM, CMS, etc." name="description">
    <meta content="Coderthemes" name="author">

    <%- include("partials/css") %>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>


</head>

<body class="loading" data-layout-color="light" data-leftbar-theme="dark" data-layout-mode="fluid"
    data-rightbar-onstart="true">
    <!-- Begin page -->
    <div class="wrapper">
        <!-- ========== Left Sidebar Start ========== -->
        <div class="leftside-menu">

            <!-- LOGO -->
            <%- include("partials/logo") %>

                <div class="h-100" id="leftside-menu-container" data-simplebar="">

                    <!--- Sidemenu -->
                    <%- include("partials/sidemenu") %>
                        <!-- End Sidebar -->

                        <div class="clearfix"></div>

                </div>
                <!-- Sidebar -left -->

        </div>
        <!-- Left Sidebar End -->

        <!-- ============================================================== -->
        <!-- Start Page Content here -->
        <!-- ============================================================== -->

        <div class="content-page">
            <div class="content">
                <!-- Topbar Start -->
                <%- include("partials/topbar") %>
                    <!-- end Topbar -->

                    <!-- Start Content-->
                    <div class="container-fluid">

                        <!-- start page title -->
                        <div class="row">
                            <div class="col-12">
                                <div class="page-title-box">
                                    <h4 class="page-title">Yemek Listesi</h4>
                                </div>
                            </div>
                        </div>

                        <div class="row">
                            <div class="col-12">
                                <div class="card">
                                    <div class="card-body">
                                        <form action="/ikyonetim/yemek-listesi-istanbul" method="POST"
                                            enctype="multipart/form-data">
                                            <div class="row mb-3">
                                                <div class="form-group col-lg-12 col-md-12 col-sm-12">
                                                    <label for="header" class="form-label">İstanbul Yemek Listesi
                                                        (Excel):</label>
                                                    <input id="yemekDosyasiIstanbul" type="file" class="form-control"
                                                        name="yemekDosyasiIstanbul" required>
                                                </div>
                                            </div>
                                            <button class="btn btn-primary" type="submit">Yükle</button>
                                        </form>
                                        <div id="output" style="margin-top: 20px;"></div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="row">
                            <div class="col-12">
                                <div class="card">
                                    <div class="card-body">
                                        <form action="/ikyonetim/yemek-listesi-dilovasi" method="POST"
                                            enctype="multipart/form-data">
                                            <div class="row mb-3">
                                                <div class="form-group col-lg-12 col-md-12 col-sm-12">
                                                    <label for="header" class="form-label">Dilovası Yemek Listesi
                                                        (Excel):</label>
                                                    <input id="yemekDosyasiDilovasi" type="file" class="form-control"
                                                        name="yemekDosyasiDilovasi" required>
                                                </div>
                                            </div>
                                            <button class="btn btn-primary" type="submit">Yükle</button>
                                        </form>
                                        <div id="output" style="margin-top: 20px;"></div>
                                    </div>
                                </div>
                            </div>
                        </div>


                        <!-- end page title -->

                        <!-- end row -->

                        <!-- end row -->
                    </div>
                    <!-- container -->

            </div> <!-- content -->

            <!-- Footer Start -->
            <%- include("partials/footer") %>
                <!-- end Footer -->

        </div>

        <!-- ============================================================== -->
        <!-- End Page content -->
        <!-- ============================================================== -->


    </div>
    <!-- END wrapper -->

    <%- include("partials/scripts") %>

        <!-- <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
        <script>
            document.getElementById('yemekDosyasi').addEventListener('change', function (event) {
                const file = event.target.files[0];
                if (!file) {
                    alert("Lütfen bir Excel dosyası seçin!");
                    return;
                }

                const reader = new FileReader();

                reader.onload = function (e) {
                    const data = new Uint8Array(e.target.result);
                    const workbook = XLSX.read(data, { type: 'array' });
                    const sheetName = workbook.SheetNames[0];
                    const sheet = workbook.Sheets[sheetName];

                    // Sheet'i JSON formatına çevir
                    const json = XLSX.utils.sheet_to_json(sheet, { header: 1, raw: false });

                    // B9:L73 aralığını seç
                    const selectedRows = json.slice(8, 73).map(row => row.slice(1, 12)); // B'den L'ye kadar

                    // Veriyi tabloda göster
                    displayData(selectedRows);
                };

                reader.readAsArrayBuffer(file);
            });

            function displayData(data) {
                const outputDiv = document.getElementById('output');
                outputDiv.innerHTML = '';

                const table = document.createElement('table');
                table.style.borderCollapse = 'collapse';
                table.style.width = '100%';

                // Tablo başlığı oluştur
                const thead = document.createElement('thead');
                const headerRow = document.createElement('tr');
                for (let i = 1; i <= 10; i++) {
                    const th = document.createElement('th');
                    th.textContent = `Sütun ${i}`;
                    th.style.border = '1px solid #ddd';
                    th.style.padding = '8px';
                    th.style.backgroundColor = '#f8f9fa';
                    headerRow.appendChild(th);
                }
                thead.appendChild(headerRow);
                table.appendChild(thead);

                // Tablo gövdesini oluştur
                const tbody = document.createElement('tbody');
                data.forEach(row => {
                    const tr = document.createElement('tr');
                    row.forEach(cell => {
                        const td = document.createElement('td');
                        td.textContent = cell || ''; // Hücre boşsa boş bırak
                        td.style.border = '1px solid #ddd';
                        td.style.padding = '8px';
                        tr.appendChild(td);
                    });
                    tbody.appendChild(tr);
                });

                table.appendChild(tbody);
                outputDiv.appendChild(table);
            }
        </script> -->





</body>

</html>
